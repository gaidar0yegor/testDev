{% extends 'base.html.twig' %}

{% block title %}Mes absences{% endblock %}

{% block body %}

<h1>Indiquez vos jours d'absence</h1>

<h2 class="mb-4 align-items-center">
    <a href="{{ path('absences_', {'year': prev|date('Y'), 'month': prev|date('m')}) }}">
        <i class="fa fa-angle-left fa-lg"></i>
    </a>
    <span class="mx-3">
        {{ cra.mois|format_date(pattern='MMMM Y')|capitalize }}
    </span>
    <a href="{{ path('absences_', {'year': next|date('Y'), 'month': next|date('m')}) }}">
        <i class="fa fa-angle-right fa-lg"></i>
    </a>
</h2>

<div class="row">
    <div class="col-md-8 offset-md-2 col-lg-6 offset-lg-3">
        <div class="message-validation text-center">
            {% if cra.isCraSubmitted %}
                <p class="text-success">
                    <i class="fa fa-check" aria-hidden="true"></i>
                    Vous avez enregistré ce mois le {{ cra.craModifiedAt|format_date }}.
                </p>
            {% elseif currentOrPreviousMonth(cra.mois) %}
                <p class="text-warning">
                    <i class="fa fa-exclamation" aria-hidden="true"></i>
                    Vous devriez enregistrer vos absences de ce mois.
                </p>
            {% endif %}
        </div>

        {#
            Calendrier affiché temporairement en attendant le chargement des données
        #}
        <div class="calmonth">
            {% include 'temps/_calendrier_vide.html.twig' %}
        </div>
    </div>
</div>

<div class="d-flex justify-content-center mt-4">
    <button type="submit" class="btn btn-success btn-validate-cra my-3">Enregistrer</button>
</div>

{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script src="{{ asset('js/Cra.js') }}"></script>

    <script type="text/javascript">
        const date = {{ {'year': year, 'month': month}|json_encode|raw }};
        const craJours = {{ cra.jours|json_encode|raw }};

        initAbsences(date, craJours);
    </script>
{% endblock %}
