{% extends "base.html.twig" %}

{% block title %}Projet {{ projet.titre }} | {{ parent() }}{% endblock %}

{% block body %}

<div>
    <h1>Projet {{ projet.acronyme }}</h1>
</div>

<p class="text-center">
    {% if projet.projetCollaboratif %}
        <span class="badge badge-success">Collaboratif</span>
    {% endif %}
    {% if projet.projetInterne %}
        <span class="badge badge-success">Interne</span>
    {% endif %}
    {% if projet.projetPpp %}
        <span class="badge badge-success">PPP - R&amp;D</span>
    {% endif %}
    {% if projet.statutRdi %}
        <span class="badge badge-success">Elligible RDI</span>
    {% endif %}
</p>

<div class="container table">    
    <div class="row">
        <div class="col-md-2 bordure"><strong>Titre : </strong></div>
        <div class="col-md-10 bordure"> {{ projet.titre }}</div>
    </div></br>
    <div class="row">
        <div class="col-md-2 bordure"><strong>Résumé : </strong></div>
        <div class="col-md-10 bordure"> {{ projet.resume|nl2br }}</div>        
    </div></br>
    <div class="row">
        <div class="col-md-2 bordure"><strong>Chef de projet : </strong></div>
        <div class="col-md-10 bordure"> {{ projet.chefDeProjet.fullname }}</div>
    </div></br>
    <div class="row">
        <div class="col-md-2 bordure"><strong>Date de début : </strong></div>
        <div class="col-md-10 bordure"> {{ projet.dateDebut|format_date }}</div>        
    </div></br>
    {% if projet.dateFin %}
        <div class="row">
            <div class="col-md-2 bordure"><strong>Date de fin : </strong></div>
            <div class="col-md-10 bordure"> {{ projet.dateFin|format_date }}</div>
        </div></br>
    {% endif %}
    <div class="row">
        <div class="col-md-2 bordure"><strong>Statut : </strong></div>
        <div class="col-md-10 bordure"> {{ projet.statutProjet.libelle }}</div>        
    </div></br> 
</div>

<div class="row_projet">
    <div class="col-6">
        <a
            href="{{ path('liste_fichiers_', {'id': projet.id}) }}"
            class="btn btn-rdi btn-block mt-2"
        >Fichiers</a>
        <a
            href="{{ path('projet_participant', {'id': projet.id}) }}"
            class="btn btn-rdi btn-block mt-2 {{ userCanEditProjet ? '' : 'disabled' }}"
            {% if not userCanEditProjet %}
                title="Seul le chef de projet peut gérer les participants"
            {% endif %}
        >Participants</a>        
    </div>
    <div class="col-6 bis">
        <a
            href="{{ path('projet_edition', {'id': projet.id}) }}"
            class="btn btn-rdi btn-block mt-2 {{ userCanEditProjet ? '' : 'disabled' }}"
            {% if not userCanEditProjet %}
                title="Seul le chef de projet peut modifier"
            {% endif %}
        >Modifier Projet</a>
        <a
            href="{{ path('fait_marquant_ajouter', {projetId: projet.id}) }}"
            class="btn btn-rdi btn-block mt-2 {{ userCanAddFaitMarquant ? '' : 'disabled' }}"
            {% if not userCanAddFaitMarquant %}
                title="Seuls les contributeurs du projet peuvent ajouter un fait marquant"
            {% endif %}
        >Fait marquant</a>
    </div>
</div>


<section id="timeline">
    <h2 class="facts">Faits marquants</h2>

    {% if projet.hasFaitMarquants() %}
    <ul class="timeline">
        {% for faitMarquant in projet.faitMarquants %}
            <li class="event">
                <h4 style="font-size: 1em" data-date="{{ faitMarquant.date|format_date }}">{{ faitMarquant.date|format_date }} - <span>{{ faitMarquant.createdBy.prenom }} {{ faitMarquant.createdBy.nom }}</span></h4>
                <h3>{{ faitMarquant.titre }}</h3>
                <p class="text-justify">
                    {{ faitMarquant.description|nl2br }}
                </p>
                <div class="font-awesome" style="text-align: end;">
                    <a href="{{ path('fait_marquant_modifier', {'id': faitMarquant.id}) }}"><i class="fa fa-edit" style="font-size: 1.5em;"></i></a>
                </div>
            </li>
        {% endfor %}
    </ul>
    {% else %}
        <p>Ce projet n'a pas encore de fait marquants.</p>
    {% endif %}
</section>

{% endblock %}

