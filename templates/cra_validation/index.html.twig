{% extends 'base.html.twig' %}

{% block title %}Validation des temps de {{ year }} | {{ parent() }}{% endblock %}

{% block body %}

<h1>Validation des temps de {{ year }}</h1>

<ul class="list-inline text-center mb-4">
    {% for yearSwitch in '-3 years'|date('Y')..'+1 months'|date('Y') %}
        {% if yearSwitch == year %}
            <li class="list-inline-item m-0">{{ yearSwitch }}</li>
        {% else %}
            <li class="list-inline-item m-0">
                <a href="{{ path('app_fo_admin_cra_validation', {year: yearSwitch}) }}">{{ yearSwitch }}</a>
            </li>
        {% endif %}

        {% if not loop.last %}
            -
        {% endif %}
    {% endfor %}
</ul>

<table class="table table-responsive-md">
    <thead>
        <tr>
            <th>Utilisateur</th>
            {% for mois in 1..12 %}
                <th class="text-center">
                    <span class="d-lg-none">{{ [year, mois]|join('-')|format_date(pattern='MMMMM') }}</span>
                    <span class="d-none d-lg-inline">{{ [year, mois]|join('-')|format_date(pattern='MMM') }}</span>
                </th>
            {% endfor %}
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
            <tr {% if not user.enabled %}class="table-secondary"{% endif %}>
                <td><a href="{{ path('app_fo_admin_user', {'id': user.id}) }}">{{ user.fullname }}</a></td>
                {% for mois in 1..12 %}
                    {% include 'cra_validation/_cra-info.html.twig' with {'yearMonth': [year, '%02d'|format(mois)]|join('-')} %}
                {% endfor %}
                <td>
                    {% if user.enabled %}
                    {% else %}
                        Compte désactivé
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
