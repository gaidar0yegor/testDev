{% extends "base.html.twig" %}

{% block title %}Mon compte{% endblock %}

{% block body %}
    
    <style>        
        a:hover {text-decoration: none;  }
        .form-control col-sm-3 {position: absolute;}
        .img_logo {position: absolute; left: 4%; top: 8%; }
        .img_logo img {height: 50px; }

        .title {position: relative; left: -2%; }
        /* .title {display: flex; justify-content: space-around; } */
        i {color: black; }
        .table thead th {background-color: #ce352c; color: white; }
        tr, td {background-color: #e6e6e6; }
        .btn-success {color: white; background-image: linear-gradient(to bottom, #729EBF 0%, #333A40 100%); border: none; }
        .chart {display: flex; justify-content: space-between; }

    /**********************************************RESPONSIVE DESIGN**************************************************/
    @media screen and (min-width: 1024px)
    {
        /* .chart {display: flex; justify-content: space-between; } */
    }
    @media screen and (min-width: 970px)
    {
        body {
            overflow-x: hidden;
        }
        .chart {
            display: flex;
            /* flex-direction: column;  */
            /* flex-wrap: wrap;  */
            justify-content: center;
            align-items: center;
        }
        .container {
            position: relative;
            left: 2.5%;
            max-width: 50%;
        }
    }
    @media screen and (max-width: 792px)
    {
        body {
            overflow-x: hidden;
            min-height: 300px; 
        }
        .select {
            position: absolute; 
            left: 10%;
            top: 30%;
        }
        .chart {
            flex-direction: column;
        }
    }
    @media screen and (min-width: 650px)
    {
        body {
            overflow-x: hidden;
        }
        .title {
            text-align: center; 
            position: relative; 
            right: 10%;
        }


        #piechart_3D {
            width: 1000%;
        }
    }
    @media screen and (min-width: 540px) and (max-width: 650px)
    {
        body {
            overflow-x: hidden;
        }
        .title {
            text-align: center;
        }
        .select {
            position: absolute;
            bottom: 20%;
        }
        .personne {
            display: none;
        }
    }
    @media screen and (max-width: 540px)
    {
        #menu-demo2 {
            display: flex; 
            flex-direction: column;
            flex-wrap: wrap;
            justify-content: center;          
        }
        .personne {
            display: none;
        }
        .select {
            position: absolute;
            left: 70%;
            bottom: 20%;
        }
    }
    </style>

    <section style="height: 800px;">

        <div class="title text-center">
            <h1>Projets de l'année</h1>
        </div>
        <div class="col-lg-3 mx-auto">
            <select name="select" class="form-control" id="dropdownYear" onchange="getProjectReportFunc()"></select>                 
        </div>
        <div class="chart mt-5">
            <div id="piechart_3d" class="text-center mx-auto" style="width: 4000%; height: 400px;"></div>
            <div id="myDiv" class="text-center mx-auto"   style="width: 4000%; height: 400px;">Projets des trois dernières années</div>
        </div>            

        <table class="table table-bordered mx-auto m-5"  style="max-width: 67.9%;">
            <thead>
                <tr class="table table-secondary">
                    <th scope="col">TABLEAU DE BORD</th>
                    <th scope="col" class="text-center">ID</th>
                    <th scope="col" class="text-center">Équipe</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th scope="row">Nombre de projets de l'année en cours</th>
                    <td class="text-center">0</td>
                    <td class="text-center">0</td>
                </tr>
                <tr>
                    <th scope="row">Nombre de projets de type CIR-CII</th>
                    <td class="text-center">0</td>
                    <td class="text-center">0</td>
                </tr>
                <tr>
                    <th scope="row">Temps total passé en  heures</th>
                    <td class="text-center">0</td>
                    <td class="text-center">0</td>
                </tr>
            </tbody>
        </table>

        <div class="button text-center mb-5">
            <a href="fo-temps-01.php"><input type="button" class="btn btn-success" value="Mettre à jour votre feuille de temps"></a>
        </div>

    </section>

{% endblock %}

{% block javascripts %}
<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    google.charts.load("current", {packages:["corechart"]});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
        var data = google.visualization.arrayToDataTable([
        ['Statuts', 'Speakers (in pourcents)'],
        ['En cours',85], ['Terminé', 15], ['Suspendu', 4],
        ]);
        var options = {
        title: 'Projets réalisés depuis 2017',
        is3D: true,
        //   legend: 'none',
        pieSliceText: 'label',
        slices: { 4: {offset: 0.9}, 12: {offset: 0.3}, 14: {offset: 0.4}, 15: {offset: 0.5},},
        };

        var chart = new google.visualization.PieChart(document.getElementById('piechart_3d'));
        chart.draw(data, options);
    }

    var x = ["2015","2015","2016","2016", "2017"]
    var y = ["1","1","3","10","23"]

    var data = [
        {
        histfunc: "RDI",
        y: y,
        x: x,
        type: "histogram",
        name: "RDI"
        },
        {
        histfunc: "Non RDI",
        y: y,
        x: x,
        type: "histogram",
        name: "Non RDI"
        }
    ]

    Plotly.newPlot('myDiv', data)

    $('#dropdownYear').each(function() {

        var year = (new Date()).getFullYear();
        var current = year;
        // year += 4;
        for (var i = 0; i < 5; i++) {
            if ((year+i) == current)
            $(this).append('<option selected value="' + (year - i) + '">' + (year - i) + '</option>');
            else
            $(this).append('<option value="' + (year - i) + '">' + (year - i) + '</option>');
        }
    })
</script>
{% endblock %}
